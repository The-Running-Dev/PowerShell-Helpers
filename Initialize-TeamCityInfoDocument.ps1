function Initialize-TeamCityInfoDocument([string]$buildNumber = '', [boolean]$status = $true, [string[]]$statusText = $null, [System.Collections.IDictionary]$statistics = $null) {
    $doc = New-Object xml;
    $buildEl = $doc.CreateElement('build');

    if (![string]::IsNullOrEmpty($buildNumber)) {
        $buildEl.SetAttribute('number', $buildNumber);
    }

    $buildEl = $doc.AppendChild($buildEl);
    $statusEl = $doc.CreateElement('statusInfo');

    if ($status) {
        $statusEl.SetAttribute('status', 'SUCCESS');
    }
    else {
        $statusEl.SetAttribute('status', 'FAILURE');
    }

    if ($statusText -ne $null) {
        foreach ($text in $statusText) {
            $textEl = $doc.CreateElement('text');
            $textEl.SetAttribute('action', 'append');
            $textEl.set_InnerText($text);
            $textEl = $statusEl.AppendChild($textEl);
        }
    }

    $statusEl = $buildEl.AppendChild($statusEl);

    if ($statistics -ne $null) {
        foreach ($key in $statistics.Keys) {
            $val = $statistics.$key
            if ($val -eq $null) {
                $val = ''
            }

            $statEl = $doc.CreateElement('statisticsValue');
            $statEl.SetAttribute('key', $key);
            $statEl.SetAttribute('value', $val.ToString());
            $statEl = $buildEl.AppendChild($statEl);
        }
    }

    return $doc;
}